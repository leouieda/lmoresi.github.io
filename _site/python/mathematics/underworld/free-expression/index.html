<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Mathematics and Code &#8211; Home</title>
<meta name="description" content="This post was originally written for the “logdown” platform but I recently ported the whole lot across to github and their jekyll-based environment. I have therefore generalised my comments and I am showing only what works on github too. [ Sept 4, 2015 ]

">
<meta name="keywords" content="">



<!-- Twitter Cards -->
<meta name="twitter:title" content="Mathematics and Code">
<meta name="twitter:description" content="This post was originally written for the “logdown” platform but I recently ported the whole lot across to github and their jekyll-based environment. I have therefore generalised my comments and I am showing only what works on github too. [ Sept 4, 2015 ]

">
<meta name="twitter:site" content="@louismoresi">
<meta name="twitter:creator" content="@louismoresi">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/images/default-thumb.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Mathematics and Code">
<meta property="og:description" content="This post was originally written for the “logdown” platform but I recently ported the whole lot across to github and their jekyll-based environment. I have therefore generalised my comments and I am showing only what works on github too. [ Sept 4, 2015 ]

">
<meta property="og:url" content="/python/mathematics/underworld/free-expression/">
<meta property="og:site_name" content="Home">

<meta property="og:image" content="/images/default-thumb.png">






<link rel="canonical" href="/python/mathematics/underworld/free-expression/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Home Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="/assets/js/vendor/html5shiv.min.js"></script>
	<script src="/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700%7CPT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="/">Home</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
				    
				        
				    
				    <li><a href="/pages/ListOfPosts/" >posts</a></li>
				
				    
				        
				    
				    <li><a href="/pages/CV/" >CV</a></li>
				
				    
				        
				    
				    <li><a href="/pages/Pubs/" >Publications</a></li>
				
				    
				        
				    
				    <li><a href="/pages/Research/" >Research</a></li>
				
				    
				        
				        
				    <li><a href="http://www.facebook.com/underworldcode" target="_blank">Underworld News</a></li>
				
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->



<div id="main" role="main">
  <div class="article-author-side">
    


<div itemscope itemtype="http://schema.org/Person">


	<img src="/images/bio-photo.jpg" class="bio-photo" alt="Louis Moresi bio photo">


  <h3 itemprop="name">Louis Moresi</h3>
  <p>Geodynamics</p>
  <a href="mailto:louis.moresi@unimelb.edu.au" class="author-social" target="_blank"><i class="fa fa-fw fa-envelope-square"></i> Email</a>
  <a href="http://twitter.com/louismoresi" class="author-social" target="_blank"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a>
  <a href="http://facebook.com/louismoresi" class="author-social" target="_blank"><i class="fa fa-fw fa-facebook-square"></i> Facebook</a>
  
  
  
  
  
  <a href="http://github.com/lmoresi" class="author-social" target="_blank"><i class="fa fa-fw fa-github"></i> Github</a>
  
  
  
  
  
  
  
  
  
  
  
  <a href="http://www.researchgate.net/profile/Louis_Moresi" class="author-social" target="_blank"><i class="fa fa-fw fa-researchgate"></i> Researchgate</a>
</div>

  </div>
  <article class="post">
    <div class="headline-wrap">
      
        <h1><a href="/python/mathematics/underworld/free-expression/" rel="bookmark" title="Mathematics and Code">Mathematics and Code</a></h1>
      
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <p class="notice">This post was originally written for the “logdown” platform but I recently ported the whole lot across to github and their jekyll-based environment. I have therefore generalised my comments and I am showing only what works on github too. [ <strong>Sept 4, 2015</strong> ]</p>

<p>We’ve had a frantic phase of development in <code>Underworld</code> recently with a new <code>python</code> and <code>ipython</code> compatible version in the wings. Using the <code>ipython notebook</code> environment exclusively for a couple of weeks has rekindled my appreciation of <code>(multi)markdown</code> for documentation and the power of rendering mathematics with <code>mathjax</code>. I even gave a lecture this week using <code>ipython</code> to make slides <em>(I wouldn’t actually recommend this, but it was interesting to be able do live demonstrations where I could modify my code to show off some numerical instabilities)</em>.</p>

<p>I wondered if there was a web-hosting or blogging site that had the  markdown, mathematics, code-highlighting capabilities of ipython notebooks, and I found <a href="www.logdown.com" title="logdown">www.logdown.com</a>. This is what it can do:</p>

<h2 id="mathematics">Mathematics</h2>

<p>Display equations rendered with mathjax as a raw displayed equation</p>
<pre>
  \\[
  S \frac{\partial h}{\partial t} + H = -\frac{\partial }{\partial x}
  \underbrace{\left( - K \frac{\partial h}{\partial x} \right)}_\text{flux}
  \\]
</pre>
<p>Producing:
\[
  S \frac{\partial h}{\partial t} + H = -\frac{\partial }{\partial x}
  \underbrace{\left( - K \frac{\partial h}{\partial x} \right)}_\text{flux}
 \]</p>

<p>and you can use inline equations so that you can explain, for example, what \( {\partial h}/{\partial t} \) means by using \\( … \\) tags.</p>

<p>Although  <code>mathjax</code> will parse <code>\begin{equation}</code> and <code>\end{equation}</code> (etc) markup successfully in some documents, it can be pretty hit and miss just how the different processing engines will battle it all out. Luckily, mathjax is <a href="http://docs.mathjax.org/en/latest/tex.html">highly configurable</a> and you can usually find some combination of things that work. If you do use the latex <code>begin</code> / <code>end</code> tags, then it is possible to switch on equation numbering and labels. Who knows if this is really portable. Here is an example that works, I just had to be careful to escape the backslashes (i.e. <code>\\begin{equation}</code>)</p>

<p>\begin{equation}
    S \frac{\partial h}{\partial t} + H = -\frac{\partial }{\partial x}
    \underbrace{\left( - K \frac{\partial h}{\partial x} \right)}_\text{flux}
\end{equation}</p>

<p>\begin{equation}
    \nabla \cdot \phi = 0
\end{equation}</p>

<h2 id="code">Code</h2>

<p>Code highlighting is also platform dependent. Markdown does this in a variety of ways, with Github using fenced code blocks and logdown adopting their strategy. In Jekyll, I found it hard to have consistent code block detection and highlighting without using the <code>liquid</code>  <code>{ % highlight language % }</code> and <code>{ % endhighlight % }</code> tags</p>

<p>Code highlighting works for \( \LaTeX \),</p>

<div class="highlight"><pre><code class="language-latex" data-lang="latex"><span class="k">\frac</span><span class="nb">{</span><span class="k">\partial</span> <span class="nb">{</span><span class="k">\bf</span> u<span class="nb">}}{</span><span class="k">\partial</span> t<span class="nb">}</span>  +
    <span class="k">\left</span>( . <span class="k">\nabla</span> <span class="nb">}</span> <span class="k">\right</span>)   =
    -<span class="k">\frac</span><span class="nb">{</span>1<span class="nb">}{</span><span class="k">\rho</span> <span class="nb">}</span><span class="k">\nabla</span> p  +  <span class="k">\textbf</span><span class="nb">{</span>F<span class="nb">}</span>  + <span class="k">\nu</span> <span class="k">\nabla</span> <span class="nb">^</span>2<span class="nb">{</span><span class="k">\bf</span> u<span class="nb">}</span></code></pre></div>

<p>python scripts:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#!/usr/bin/env python</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">      This example shows how you can add a set of particles to a swarm.</span>
<span class="sd">      Here the particles are layed out in a spiral configuration.</span>
<span class="sd">      Note that Scipy / Numpy are required for this example</span>
<span class="sd">    &#39;&#39;&#39;</span>  
    <span class="kn">import</span> <span class="nn">uwpytools</span>

    <span class="c"># init using underworld 1.x XML files</span>
    <span class="n">uwpytools</span><span class="o">.</span><span class="n">InitWithArgs</span><span class="p">(</span><span class="s">&quot;BuoyancyDrivenVanilla.xml PICellerator/PassiveTracerSwarm.xml&quot;</span><span class="p">)</span>

    <span class="n">stgdict</span> <span class="o">=</span> <span class="n">uwpytools</span><span class="o">.</span><span class="n">GetCurrentDictionary</span><span class="p">()</span>

    <span class="c"># set to initialise and solve</span>
    <span class="n">stgdict</span><span class="p">[</span><span class="s">&quot;maxTimeSteps&quot;</span><span class="p">]</span><span class="o">=-</span><span class="mi">1</span>
    <span class="n">stgdict</span><span class="p">[</span><span class="s">&quot;pauseToAttachDebugger&quot;</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">stgdict</span><span class="p">[</span><span class="s">&quot;checkpointEvery&quot;</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span></code></pre></div>

<p>and C code (C-like code … this is StGermain after all)</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;math.h&gt;</span>
    <span class="cp">#include &lt;mpi.h&gt;</span>
    <span class="cp">#include &lt;StGermain/StGermain.h&gt;</span>
    <span class="cp">#include &lt;StgDomain/StgDomain.h&gt;</span>
    <span class="cp">#include &lt;StgFEM/StgFEM.h&gt;</span>
    <span class="cp">#include &lt;PICellerator/PICellerator.h&gt;</span>

    <span class="cp">#include &quot;types.h&quot;</span>
    <span class="cp">#include &quot;RheologyClass.h&quot;</span>
    <span class="cp">#include &quot;StrainWeakening.h&quot;</span>
    <span class="cp">#include &quot;YieldRheology.h&quot;</span>
    <span class="cp">#include &quot;VonMises.h&quot;</span>
    <span class="cp">#include &quot;ConstitutiveMatrix.h&quot;</span>

    <span class="cp">#include &lt;assert.h&gt;</span>

    <span class="cm">/*</span>
<span class="cm">     * Textual name of this class -</span>
<span class="cm">     * This is a global pointer which is used for times when you need to refer to</span>
<span class="cm">     * class and not a particular instance of a class.</span>
<span class="cm">     */</span>

    <span class="k">const</span> <span class="n">Type</span> <span class="n">VonMises_Type</span> <span class="o">=</span> <span class="s">&quot;VonMises&quot;</span><span class="p">;</span>

    <span class="cm">/* Public Constructor */</span>
    <span class="n">VonMises</span><span class="o">*</span> <span class="n">VonMises_New</span><span class="p">(</span>
       <span class="n">Name</span>                 <span class="n">name</span><span class="p">,</span>
       <span class="n">AbstractContext</span><span class="o">*</span>     <span class="n">context</span><span class="p">,</span>
       <span class="n">StrainWeakening</span><span class="o">*</span>     <span class="n">strainWeakening</span><span class="p">,</span>
       <span class="n">MaterialPointsSwarm</span><span class="o">*</span> <span class="n">materialPointsSwarm</span><span class="p">,</span>
       <span class="kt">double</span>               <span class="n">minVisc</span><span class="p">,</span>
       <span class="kt">int</span>                   <span class="n">strainRateTag</span><span class="p">,</span>
       <span class="kt">double</span>               <span class="n">cohesion</span><span class="p">,</span>
       <span class="kt">double</span>               <span class="n">cohesionAfterSoftening</span><span class="p">,</span>
       <span class="n">Bool</span>                 <span class="n">strainRateSoftening</span> <span class="p">)</span></code></pre></div>

<p>I highly recommend the logdown platform. If you are using github, though, it is not too much of a stretch to get things working directly with Jekyll and keep everything in one spot. We’ll see, I suppose !</p>

      <hr />
      <footer role="contentinfo">
        <div class="social-share">
  <h4>Share on</h4>
  <ul>
    <li>
      <a href="https://twitter.com/intent/tweet?text=/python/mathematics/underworld/free-expression/" class="twitter" title="Share on Twitter"><i class="fa fa-twitter"></i><span> Twitter</span></a>
    </li>
    <li>
      <a href="https://www.facebook.com/sharer/sharer.php?u=/python/mathematics/underworld/free-expression/" class="facebook" title="Share on Facebook"><i class="fa fa-facebook"></i><span> Facebook</span></a>
    </li>
    <li>
      <a href="https://plus.google.com/share?url=/python/mathematics/underworld/free-expression/" class="google-plus" title="Share on Google Plus"><i class="fa fa-google-plus"></i><span> Google+</span></a>
    </li>
  </ul>
</div><!-- /.social-share -->
        <p class="byline"><strong>Mathematics and Code</strong> was published on <time datetime="2014-04-03T10:47:00+11:00">April 03, 2014</time> and last modified on <time datetime="2015-09-03">September 03, 2015</time>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  
    <section id="disqus_thread"></section><!-- /#disqus_thread -->
  
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="/posts/">View all posts</a>)</small></h4>
    <ul>
    
      <li><a href="/underworld-2/" title="Underworld 2 ">Underworld 2 </a></li>
    
      <li><a href="/viscoelasticity-in-underworld/" title="Viscoelasticity in Underworld">Viscoelasticity in Underworld</a></li>
    
      <li><a href="/visiting-timor/" title="Visiting Timor">Visiting Timor</a></li>
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  
  <footer>
    

<span>&copy; 2015 Louis Moresi. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://mademistakes.com/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

<script type="text/javascript"
        src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



  
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'louismoresi'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>




</body>
</html>
